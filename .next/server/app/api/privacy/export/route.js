"use strict";(()=>{var e={};e.id=2047,e.ids=[2047],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},180:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>_,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>x,staticGenerationAsyncStorage:()=>l});var s={};t.r(s),t.d(s,{POST:()=>c});var a=t(22060),o=t(72433),i=t(10137),n=t(16097),p=t(20095);async function c(e){try{let e=await (0,p.createClient)(),{data:{user:r}}=await e.auth.getUser();if(!r)return n.NextResponse.json({error:"Unauthorized"},{status:401});let[{data:t},{data:s},{data:a},{data:o},{data:i}]=await Promise.all([e.from("profiles").select("*").eq("id",r.id).single(),e.from("cases").select("*").or(`user_id.eq.${r.id},owner_user_id.eq.${r.id},creator_user_id.eq.${r.id}`),e.from("case_responses").select("*").in("case_id",(await e.from("cases").select("id").eq("user_id",r.id)).data?.map(e=>e.id)||[]),e.from("payments").select("*").eq("user_id",r.id),e.from("case_outcomes").select("*").in("case_id",(await e.from("cases").select("id").eq("user_id",r.id)).data?.map(e=>e.id)||[])]),c={generated_at:new Date().toISOString(),user:{id:r.id,email:r.email},profile:t||null,cases:s||[],case_responses:a||[],payments:o||[],case_outcomes:i||[]};return n.NextResponse.json(c)}catch(e){return console.error("[privacy] export error:",e),n.NextResponse.json({error:"Failed to export data"},{status:500})}}let u=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/privacy/export/route",pathname:"/api/privacy/export",filename:"route",bundlePath:"app/api/privacy/export/route"},resolvedPagePath:"/workspaces/cursor-guidebuoy-ai-sg/app/api/privacy/export/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:x}=u,m="/api/privacy/export/route";function _(){return(0,i.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:l})}},20095:(e,r,t)=>{t.r(r),t.d(r,{createClient:()=>o});var s=t(54778),a=t(4599);async function o(){let e=await (0,a.cookies)();return(0,s.createServerClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,{cookies:{getAll:()=>e.getAll(),setAll(r){try{r.forEach(({name:r,value:t,options:s})=>e.set(r,t,s))}catch{}}}})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[2461,9582,3364],()=>t(180));module.exports=s})();